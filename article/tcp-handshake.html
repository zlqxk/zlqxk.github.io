<!DOCTYPE html><html><head><meta name="keywords" content="前端,react,babel,ts,typescript,学习记录"/><meta name="description" content="学习和分享工作生活中遇到的问题，记录前沿的技术，分享技术文章。"/><meta name="google-site-verification" content="s-VsAQCdV_MrjX9LC-rvr6SZ-MYSM4y1vVMJ9Fw7Oxo"/><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>Tcp 三次握手</title><meta name="description" content="Tcp 三次握手"/><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/cf2d2167c5644ef0de3a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/cf2d2167c5644ef0de3a.css" data-n-g=""/><link rel="preload" href="/_next/static/css/2c29b5f4059231122a7f.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2c29b5f4059231122a7f.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-fb76148cfcfb42ca18eb.js" defer=""></script><script src="/_next/static/chunks/framework-895f067827ebe11ffe45.js" defer=""></script><script src="/_next/static/chunks/main-c4f2541b93e4ae8b71f8.js" defer=""></script><script src="/_next/static/chunks/pages/_app-472761f2aef6a4dd81fc.js" defer=""></script><script src="/_next/static/chunks/800-724b2f069f0c30072447.js" defer=""></script><script src="/_next/static/chunks/pages/article/tcp-handshake-75b26781801ed7e8c178.js" defer=""></script><script src="/_next/static/E-yMlcZOffAX6cd0TJKvF/_buildManifest.js" defer=""></script><script src="/_next/static/E-yMlcZOffAX6cd0TJKvF/_ssgManifest.js" defer=""></script></head><script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><body class="dark"><div id="__next"><div class="Layout_layout__1EnHR"><div class="Header_header__3Hw3A"><h1 class="Header_title__2jGsC"><a href="/">BLOG ZHANG</a></h1><div class="Switch_switch__11c0w"><div class="Switch_switchWarp__1Gqov"><div class="Switch_switchLeft__3OCuZ"> <img src="/moon.png" alt="" width="16" height="16"/></div><div class="Switch_switchRigth__1Wjdr"><img src="/sun.png" alt="" width="16" height="16"/></div></div><div class="Switch_switchCheck__1aiIo Switch_dark__2WQ89"></div></div></div><div class="ImgPreview_imgPreview__2OxIp"><img src=""/></div><article class="post_article__2Kkhj"><h1>TCP 三次握手</h1>
<p>6 月 7, 2022 • ☕️☕️☕️ 10 min read</p>
<p>本文将通过 WiresShark 抓包来详细看下 TCP 三次握手的过程。</p>
<p><img src="/tcp-handshake/all_handshake.jpg" alt="all_handshake"></p>
<h2>第一次</h2>
<p>客户端向服务端发送了一条 SYN 报文。同时携带序列号 Seq = 0。</p>
<p><img src="/tcp-handshake/first.jpg" alt="first"></p>
<h2>第二次</h2>
<p>服务端向客户端发送了一条 SYN、ACK 报文。同时携带序列号 Seq = 0 和对上一个报文的确认字段 Ack = 1，代表的是 Seq = 1 之前的报文都接收到了。</p>
<p><img src="/tcp-handshake/second.jpg" alt="second"></p>
<h2>第三次</h2>
<p>客户端向服务端发送了一条 ACK 报文。同时携带序列号 Seq = 1 和对上一个报文的确认字段 Ack = 1。</p>
<p><img src="/tcp-handshake/third.jpg" alt="third"></p>
<p>到这里 Tcp 三次握手就结束了，通信双方已经建立了可靠连接，让我们看一个经典问题，为什么需要三次握手？</p>
<h2>为什么需要三次握手</h2>
<p>TCP 作为一个可靠的传输协议，其核心就是保证数据可靠传输，又要提高传输效率。设计成三次握手的主要原因是为了防止旧的重复的连接引起连接混乱的问题。举个例子，在一个很差的网络环境下，客户端发起了一个连接请求，但是在某个网络节点滞留了，一直延误到连接释放后才到达服务端，这个时候服务端以为客户端又要与其发起连接，于是回应了一个 ACK 报文。如果没有三次握手，服务端在发送了这个 ACK 报文后就会建立链接，等待客户端发送数据。但是客户端并未发起连接请求，也不会向服务端发送请求，于是服务端就这样一直等待客户端发送消息，白白浪费服务端的资源。</p>
</article><div class="Footer_footer__316w0"><div class="Footer_footerInfo__Oa_Q4"><a href="https://github.com/zlqxk/awesome-blog">Github</a></div><div class="Footer_footerPvUv__YWOzD" id="busuanzi_container_site_pv"><p>本站总访问量<span id="busuanzi_value_site_pv"></span>次</p><p>访客数<span id="busuanzi_value_site_uv"></span>人次</p></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/article/tcp-handshake","query":{},"buildId":"E-yMlcZOffAX6cd0TJKvF","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>